@startuml EditorIntegrationSequence
participant ":Command" as Command
participant "<<class>>\nEditorUtil" as EditorUtil
participant ":System" as System
participant ":Process" as Process

hide footbox
activate Command

' Command calls EditorUtil
Command -> EditorUtil: openInEditor(filePath)
activate EditorUtil

' Check if file exists
EditorUtil -> System: file.exists()
opt File missing
    EditorUtil --> Command: throw NoNoteFoundException
end

' Check console availability
EditorUtil -> System: System.console()
opt No console
    EditorUtil --> Command: throw EditorNotFoundException
end

' Editor launch logic
EditorUtil -> System: getenv("VISUAL") / getenv("EDITOR")
EditorUtil -> System: getProperty("os.name")
alt Editor launches successfully via env var
    EditorUtil -> Process: tryLaunchEditor(editor, file)
    Process --> EditorUtil: exitCode
else Env var failed, try OS-specific fallback
    alt Windows
        EditorUtil -> Process: tryLaunchEditor("notepad.exe", file)
        Process --> EditorUtil: exitCode
    else Other OS
        EditorUtil -> Process: tryLaunchEditor("vim/nano/vi", file)
        Process --> EditorUtil: exitCode
    end
    opt All OS fallback attempts failed
        EditorUtil --> Command: throw EditorNotFoundException
    end
end

EditorUtil --> Command: return (success)
deactivate EditorUtil

@enduml
